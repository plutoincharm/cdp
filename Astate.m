function A = Astate(x,u,dt)

global m1 m2 L1 L2 g
a11 = 1+(1/2).*dt.^2.*((-1).*L1.*L2.*m2.*cos(x(1)+(-1).*x(2)).*(L1.*L2.* ...
  m2.*x(3).*(x(3)+(-1).*x(4)).*cos(x(1)+(-1).*x(2))+L1.*L2.*m2.* ...
  x(3).*x(4).*cos(x(1)+(-1).*x(2))).*(L1.^2.*L2.^2.*m1.*m2+L1.^2.* ...
  L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos(x(1)+(-1).*x(2)).^2) ...
  .^(-1)+L2.^2.*m2.*((-1).*g.*L1.*(m1+m2).*cos(x(1))+(-1).*L1.*L2.* ...
  m2.*x(3).*x(4).*cos(x(1)+(-1).*x(2))+L1.*L2.*m2.*(x(3)+(-1).*x(4)) ...
  .*x(4).*cos(x(1)+(-1).*x(2))).*(L1.^2.*L2.^2.*m1.*m2+L1.^2.* ...
  L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos(x(1)+(-1).*x(2)).^2) ...
  .^(-1)+(-2).*L1.^2.*L2.^4.*m2.^3.*cos(x(1)+(-1).*x(2)).*(L1.^2.* ...
  L2.^2.*m1.*m2+L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos( ...
  x(1)+(-1).*x(2)).^2).^(-2).*sin(x(1)+(-1).*x(2)).*(u(1)+(-1).*u(2)+( ...
  -1).*g.*L1.*(m1+m2).*sin(x(1))+(-1).*L1.*L2.*m2.*x(3).*x(4).*sin( ...
  x(1)+(-1).*x(2))+L1.*L2.*m2.*(x(3)+(-1).*x(4)).*x(4).*sin(x(1)+( ...
  -1).*x(2)))+2.*L1.^3.*L2.^3.*m2.^3.*cos(x(1)+(-1).*x(2)).^2.*( ...
  L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.* ...
  m2.^2.*cos(x(1)+(-1).*x(2)).^2).^(-2).*sin(x(1)+(-1).*x(2)).*(u(2)+ ...
  L1.*L2.*m2.*x(3).*(x(3)+(-1).*x(4)).*sin(x(1)+(-1).*x(2))+(-1).* ...
  L2.*m2.*((-1).*L1.*x(3).*x(4).*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))) ...
  +L1.*L2.*m2.*(L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.^2.*m2.^2+(-1).* ...
  L1.^2.*L2.^2.*m2.^2.*cos(x(1)+(-1).*x(2)).^2).^(-1).*sin(x(1)+(-1) ...
  .*x(2)).*(u(2)+L1.*L2.*m2.*x(3).*(x(3)+(-1).*x(4)).*sin(x(1)+(-1).* ...
  x(2))+(-1).*L2.*m2.*((-1).*L1.*x(3).*x(4).*sin(x(1)+(-1).*x(2))+ ...
  g.*sin(x(2)))));


a12=(1/2).*dt.^2.*(L2.^2.*m2.*(L1.*L2.*m2.*x(3).*x(4).*cos(x(1)+(-1).* ...
  x(2))+(-1).*L1.*L2.*m2.*(x(3)+(-1).*x(4)).*x(4).*cos(x(1)+(-1).* ...
  x(2))).*(L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.* ...
  L2.^2.*m2.^2.*cos(x(1)+(-1).*x(2)).^2).^(-1)+(-1).*L1.*L2.*m2.* ...
  cos(x(1)+(-1).*x(2)).*(L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.^2.*m2.^2+( ...
  -1).*L1.^2.*L2.^2.*m2.^2.*cos(x(1)+(-1).*x(2)).^2).^(-1).*((-1).* ...
  L1.*L2.*m2.*x(3).*(x(3)+(-1).*x(4)).*cos(x(1)+(-1).*x(2))+(-1).* ...
  L2.*m2.*(L1.*x(3).*x(4).*cos(x(1)+(-1).*x(2))+g.*cos(x(2))))+2.* ...
  L1.^2.*L2.^4.*m2.^3.*cos(x(1)+(-1).*x(2)).*(L1.^2.*L2.^2.*m1.*m2+ ...
  L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos(x(1)+(-1).* ...
  x(2)).^2).^(-2).*sin(x(1)+(-1).*x(2)).*(u(1)+(-1).*u(2)+(-1).*g.*L1.*( ...
  m1+m2).*sin(x(1))+(-1).*L1.*L2.*m2.*x(3).*x(4).*sin(x(1)+(-1).* ...
  x(2))+L1.*L2.*m2.*(x(3)+(-1).*x(4)).*x(4).*sin(x(1)+(-1).*x(2)))+( ...
  -2).*L1.^3.*L2.^3.*m2.^3.*cos(x(1)+(-1).*x(2)).^2.*(L1.^2.*L2.^2.* ...
  m1.*m2+L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos(x(1)+( ...
  -1).*x(2)).^2).^(-2).*sin(x(1)+(-1).*x(2)).*(u(2)+L1.*L2.*m2.*x(3).* ...
  (x(3)+(-1).*x(4)).*sin(x(1)+(-1).*x(2))+(-1).*L2.*m2.*((-1).*L1.* ...
  x(3).*x(4).*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))+(-1).*L1.*L2.*m2.* ...
  (L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.* ...
  m2.^2.*cos(x(1)+(-1).*x(2)).^2).^(-1).*sin(x(1)+(-1).*x(2)).*(u(2)+ ...
  L1.*L2.*m2.*x(3).*(x(3)+(-1).*x(4)).*sin(x(1)+(-1).*x(2))+(-1).* ...
  L2.*m2.*((-1).*L1.*x(3).*x(4).*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))) ...
  );


a13=dt.*(1+(-1/2).*dt.*L1.*L2.*m2.*cos(x(1)+(-1).*x(2)).*(L1.^2.* ...
  L2.^2.*m1.*m2+L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos( ...
  x(1)+(-1).*x(2)).^2).^(-1).*(L1.*L2.*m2.*x(3).*sin(x(1)+(-1).* ...
  x(2))+L1.*L2.*m2.*(x(3)+(-1).*x(4)).*sin(x(1)+(-1).*x(2))+L1.*L2.* ...
  m2.*x(4).*sin(x(1)+(-1).*x(2))));

a14=(1/2).*dt.^2.*L2.^2.*m2.*(L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.^2.* ...
  m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos(x(1)+(-1).*x(2)).^2).^(-1).*( ...
  (-1).*L1.*L2.*m2.*x(3).*sin(x(1)+(-1).*x(2))+L1.*L2.*m2.*(x(3)+( ...
  -1).*x(4)).*sin(x(1)+(-1).*x(2))+(-1).*L1.*L2.*m2.*x(4).*sin(x(1)+ ...
  (-1).*x(2)));

a21=(1/2).*dt.^2.*(L1.^2.*(m1+m2).*(L1.*L2.*m2.*x(3).*(x(3)+(-1).* ...
  x(4)).*cos(x(1)+(-1).*x(2))+L1.*L2.*m2.*x(3).*x(4).*cos(x(1)+(-1) ...
  .*x(2))).*(L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.* ...
  L2.^2.*m2.^2.*cos(x(1)+(-1).*x(2)).^2).^(-1)+(-1).*L1.*L2.*m2.* ...
  cos(x(1)+(-1).*x(2)).*((-1).*g.*L1.*(m1+m2).*cos(x(1))+(-1).*L1.* ...
  L2.*m2.*x(3).*x(4).*cos(x(1)+(-1).*x(2))+L1.*L2.*m2.*(x(3)+(-1).* ...
  x(4)).*x(4).*cos(x(1)+(-1).*x(2))).*(L1.^2.*L2.^2.*m1.*m2+L1.^2.* ...
  L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos(x(1)+(-1).*x(2)).^2) ...
  .^(-1)+2.*L1.^3.*L2.^3.*m2.^3.*cos(x(1)+(-1).*x(2)).^2.*(L1.^2.* ...
  L2.^2.*m1.*m2+L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos( ...
  x(1)+(-1).*x(2)).^2).^(-2).*sin(x(1)+(-1).*x(2)).*(u(1)+(-1).*u(2)+( ...
  -1).*g.*L1.*(m1+m2).*sin(x(1))+(-1).*L1.*L2.*m2.*x(3).*x(4).*sin( ...
  x(1)+(-1).*x(2))+L1.*L2.*m2.*(x(3)+(-1).*x(4)).*x(4).*sin(x(1)+( ...
  -1).*x(2)))+L1.*L2.*m2.*(L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.^2.*m2.^2+ ...
  (-1).*L1.^2.*L2.^2.*m2.^2.*cos(x(1)+(-1).*x(2)).^2).^(-1).*sin( ...
  x(1)+(-1).*x(2)).*(u(1)+(-1).*u(2)+(-1).*g.*L1.*(m1+m2).*sin(x(1))+( ...
  -1).*L1.*L2.*m2.*x(3).*x(4).*sin(x(1)+(-1).*x(2))+L1.*L2.*m2.*( ...
  x(3)+(-1).*x(4)).*x(4).*sin(x(1)+(-1).*x(2)))+(-2).*L1.^4.*L2.^2.* ...
  m2.^2.*(m1+m2).*cos(x(1)+(-1).*x(2)).*(L1.^2.*L2.^2.*m1.*m2+ ...
  L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos(x(1)+(-1).* ...
  x(2)).^2).^(-2).*sin(x(1)+(-1).*x(2)).*(u(2)+L1.*L2.*m2.*x(3).*( ...
  x(3)+(-1).*x(4)).*sin(x(1)+(-1).*x(2))+(-1).*L2.*m2.*((-1).*L1.* ...
  x(3).*x(4).*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))));

a22=1+(1/2).*dt.^2.*((-1).*L1.*L2.*m2.*cos(x(1)+(-1).*x(2)).*(L1.*L2.* ...
  m2.*x(3).*x(4).*cos(x(1)+(-1).*x(2))+(-1).*L1.*L2.*m2.*(x(3)+(-1) ...
  .*x(4)).*x(4).*cos(x(1)+(-1).*x(2))).*(L1.^2.*L2.^2.*m1.*m2+ ...
  L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos(x(1)+(-1).* ...
  x(2)).^2).^(-1)+L1.^2.*(m1+m2).*(L1.^2.*L2.^2.*m1.*m2+L1.^2.* ...
  L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos(x(1)+(-1).*x(2)).^2) ...
  .^(-1).*((-1).*L1.*L2.*m2.*x(3).*(x(3)+(-1).*x(4)).*cos(x(1)+(-1) ...
  .*x(2))+(-1).*L2.*m2.*(L1.*x(3).*x(4).*cos(x(1)+(-1).*x(2))+g.* ...
  cos(x(2))))+(-2).*L1.^3.*L2.^3.*m2.^3.*cos(x(1)+(-1).*x(2)).^2.*( ...
  L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.* ...
  m2.^2.*cos(x(1)+(-1).*x(2)).^2).^(-2).*sin(x(1)+(-1).*x(2)).*(u(1)+( ...
  -1).*u(2)+(-1).*g.*L1.*(m1+m2).*sin(x(1))+(-1).*L1.*L2.*m2.*x(3).* ...
  x(4).*sin(x(1)+(-1).*x(2))+L1.*L2.*m2.*(x(3)+(-1).*x(4)).*x(4).* ...
  sin(x(1)+(-1).*x(2)))+(-1).*L1.*L2.*m2.*(L1.^2.*L2.^2.*m1.*m2+ ...
  L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos(x(1)+(-1).* ...
  x(2)).^2).^(-1).*sin(x(1)+(-1).*x(2)).*(u(1)+(-1).*u(2)+(-1).*g.*L1.*( ...
  m1+m2).*sin(x(1))+(-1).*L1.*L2.*m2.*x(3).*x(4).*sin(x(1)+(-1).* ...
  x(2))+L1.*L2.*m2.*(x(3)+(-1).*x(4)).*x(4).*sin(x(1)+(-1).*x(2)))+ ...
  2.*L1.^4.*L2.^2.*m2.^2.*(m1+m2).*cos(x(1)+(-1).*x(2)).*(L1.^2.* ...
  L2.^2.*m1.*m2+L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos( ...
  x(1)+(-1).*x(2)).^2).^(-2).*sin(x(1)+(-1).*x(2)).*(u(2)+L1.*L2.*m2.* ...
  x(3).*(x(3)+(-1).*x(4)).*sin(x(1)+(-1).*x(2))+(-1).*L2.*m2.*((-1) ...
  .*L1.*x(3).*x(4).*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))));


a23=(1/2).*dt.^2.*L1.^2.*(m1+m2).*(L1.^2.*L2.^2.*m1.*m2+L1.^2.*L2.^2.* ...
  m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos(x(1)+(-1).*x(2)).^2).^(-1).*( ...
  L1.*L2.*m2.*x(3).*sin(x(1)+(-1).*x(2))+L1.*L2.*m2.*(x(3)+(-1).* ...
  x(4)).*sin(x(1)+(-1).*x(2))+L1.*L2.*m2.*x(4).*sin(x(1)+(-1).*x(2)) ...
  );


a24=dt.*(1+(-1/2).*dt.*L1.*L2.*m2.*cos(x(1)+(-1).*x(2)).*(L1.^2.* ...
  L2.^2.*m1.*m2+L1.^2.*L2.^2.*m2.^2+(-1).*L1.^2.*L2.^2.*m2.^2.*cos( ...
  x(1)+(-1).*x(2)).^2).^(-1).*((-1).*L1.*L2.*m2.*x(3).*sin(x(1)+(-1) ...
  .*x(2))+L1.*L2.*m2.*(x(3)+(-1).*x(4)).*sin(x(1)+(-1).*x(2))+(-1).* ...
  L1.*L2.*m2.*x(4).*sin(x(1)+(-1).*x(2))));

a31=(1/8).*dt.*L1.^(-4).*L2.^(-3).*cos((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^(-2).*sin(( ...
  1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).^2).^(-2).*(4.*L1.*((-4).* ...
  L1.*L2.^3.*m2.*u(1).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.* ...
  L2.^3.*m2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*g.*L1.^2.* ...
  L2.^3.*m2.*(m1+m2).*sin((1/2).*dt.*x(3)+x(1)).*(m1+m2.*sin(x(1)+( ...
  -1).*x(2)).^2).^2+4.*L1.^2.*L2.^4.*m2.^2.*x(4).^2.*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2))+4.*dt.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*( ...
  L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+ ...
  m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2) ...
  .*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.* ...
  sin(x(2)))))+dt.^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.* ...
  sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+ ...
  L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).* ...
  x(2))+g.*sin(x(2))))).^2)+m2.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(16.*L1.^3.*L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).^2+(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+( ...
  -1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.* ...
  sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*( ...
  (-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*( ...
  x(1)+(-1).*x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.* ...
  L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.* ...
  m2.*((-2).*(u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos( ...
  x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.* ...
  g.*L2.*m2.*(m1+m2).*cos(x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*(( ...
  -4).*m1.*(x(3)+(-1).*x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)) ...
  .^2+4.*x(4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+( ...
  -1).*x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+(-1).*x(2))))))).*sin((1/2) ...
  .*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-2).*L1.*((2.*dt.*L2.*(( ...
  -1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)) ...
  .*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).* ...
  sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.* ...
  m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+( ...
  -1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+ ...
  L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).* ...
  L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+ ...
  8.*g.*L1.^2.*L2.^3.*m2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin(( ...
  1/2).*dt.*x(4)+x(2)))))+(1/4).*dt.*L1.^(-4).*L2.^(-3).*cos(x(1)+( ...
  -1).*x(2)).*sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .^(-3).*(m1+m2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)) ...
  .^2).^(-1).*(4.*L1.*((-4).*L1.*L2.^3.*m2.*u(1).*(m1+m2.*sin(x(1)+( ...
  -1).*x(2)).^2).^2+4.*L1.*L2.^3.*m2.*u(2).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).^2+4.*g.*L1.^2.*L2.^3.*m2.*(m1+m2).*sin((1/2).*dt.*x(3)+ ...
  x(1)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.^2.*L2.^4.* ...
  m2.^2.*x(4).^2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.*m2.* ...
  x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*(x(3)+(-1) ...
  .*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).* ...
  u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+dt.^2.*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).* ...
  x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+m2.* ...
  cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(16.*L1.^3.* ...
  L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+(2.*dt.*L2.*((-1).* ...
  u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.* ...
  sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin( ...
  x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+ ...
  (-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*(2.*dt.* ...
  L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.* ...
  sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)).*cos( ...
  x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+2.* ...
  g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).* ...
  sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*( ...
  (-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)) ...
  .^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*( ...
  x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1) ...
  .*x(2))+(-2).*L1.*((2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos( ...
  x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*( ...
  m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.* ...
  x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin( ...
  2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.* ...
  sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+ ...
  dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+( ...
  -1).*x(2))+g.*sin(x(2)))))+8.*g.*L1.^2.*L2.^3.*m2.*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*x(4)+x(2)))))+(-1/16).* ...
  dt.*L1.^(-4).*L2.^(-3).*m2.^(-1).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .^(-2).*(m1+m2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)) ...
  .^2).^(-1).*(4.*L1.*((-16).*L1.*L2.^3.*m2.^2.*u(1).*cos(x(1)+(-1).* ...
  x(2)).*sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+16.* ...
  L1.*L2.^3.*m2.^2.*u(2).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).* ...
  (m1+m2.*sin(x(1)+(-1).*x(2)).^2)+16.*g.*L1.^2.*L2.^3.*m2.^2.*(m1+ ...
  m2).*cos(x(1)+(-1).*x(2)).*sin((1/2).*dt.*x(3)+x(1)).*sin(x(1)+( ...
  -1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+4.*g.*L1.^2.*L2.^3.* ...
  m2.*(m1+m2).*cos((1/2).*dt.*x(3)+x(1)).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).^2+4.*L1.^2.*L2.^4.*m2.^2.*x(4).^2.*cos((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2).^2+16.*L1.^2.*L2.^4.*m2.^3.*x(4).^2.*cos(x(1)+(-1).*x(2)).* ...
  sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2) ...
  .*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.*m2.* ...
  x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*(L1.^2.*L2.*m2.*(m1+m2).* ...
  x(3).^2.*cos(x(1)+(-1).*x(2))+L1.*L2.*m2.*cos(x(1)+(-1).*x(2)).*( ...
  g.*m1.*cos(x(1))+m2.*(g.*cos(x(1))+L2.*x(4).^2.*cos(x(1)+(-1).* ...
  x(2))))+(-1).*L2.*m2.*sin(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.* ...
  m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2))) ...
  ))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.* ...
  L2.^2.*m2.*x(4).*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)) ...
  .*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*(L2.*m2.*cos(x(1)+(-1).*x(2)) ...
  .*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+8.*dt.*L1.* ...
  L2.^2.*m2.^2.*x(4).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos( ...
  x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin( ...
  x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).* ...
  L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+ ...
  2.*dt.^2.*(L1.^2.*L2.*m2.*(m1+m2).*x(3).^2.*cos(x(1)+(-1).*x(2))+ ...
  L1.*L2.*m2.*cos(x(1)+(-1).*x(2)).*(g.*m1.*cos(x(1))+m2.*(g.*cos( ...
  x(1))+L2.*x(4).^2.*cos(x(1)+(-1).*x(2))))+(-1).*L2.*m2.*sin(x(1)+( ...
  -1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+ ...
  L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+ ...
  u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+( ...
  -1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.* ...
  sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+dt.^2.*cos((1/2).*dt.*(x(3)+( ...
  -1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1) ...
  .*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+m2.*cos((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(64.*L1.^3.*L2.^2.*m2.* ...
  u(2).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+( ...
  -1).*x(2)).^2)+cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).* ...
  (2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+ ...
  L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+ ...
  m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+ ...
  m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).* ...
  x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.* ...
  (m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+ ...
  (-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+( ...
  -1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).* ...
  x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos( ...
  x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).* ...
  x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+( ...
  -1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.* ...
  sin(2.*(x(1)+(-1).*x(2)))))))+(2.*dt.*L1.^3.*L2.*m2.*(m1+m2).* ...
  x(3).^2.*cos(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*(2.*L2.^2.*m2.* ...
  x(4).^2.*cos(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*cos(x(1))+m2.*cos( ...
  x(1)+(-1).*x(2)).*cos(x(2)))+2.*(u(1)+(-2).*u(2)).*sin(x(1)+(-1).* ...
  x(2)))+L1.^2.*(2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).*cos(x(1)+(-1) ...
  .*x(2))+(-2).*dt.*g.*L2.*m2.*(m1+m2).*sin(x(1)).*sin(x(1)+(-1).* ...
  x(2))+L2.^2.*m2.^2.*(2.*dt.*x(3).^2.*cos(2.*(x(1)+(-1).*x(2)))+2.* ...
  dt.*x(4).^2.*cos(2.*(x(1)+(-1).*x(2)))+(-8).*x(3).*cos(x(1)+(-1).* ...
  x(2)).*sin(x(1)+(-1).*x(2))+8.*x(4).*cos(x(1)+(-1).*x(2)).*sin( ...
  x(1)+(-1).*x(2))))).*(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).* ...
  cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.* ...
  L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.* ...
  L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).* ...
  sin(2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2))+(2.*dt.*L1.*(L2.^2.*m2.*x(4).^2.*cos(x(1)+(-1).* ...
  x(2))+g.*L2.*(m1.*cos(x(1))+m2.*cos(x(1)+(-1).*x(2)).*cos(x(2)))+( ...
  -1).*u(2).*sin(x(1)+(-1).*x(2)))+L1.^2.*L2.*m2.*x(3).*(2.*dt.*x(3).* ...
  cos(2.*(x(1)+(-1).*x(2)))+(-8).*cos(x(1)+(-1).*x(2)).*sin(x(1)+( ...
  -1).*x(2)))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.* ...
  m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).* ...
  (u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+ ...
  (-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2) ...
  .*cos(x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1) ...
  .*x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin( ...
  x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.* ...
  x(4).^2.*sin(2.*(x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1) ...
  .*x(4))+x(1)+(-1).*x(2))+(-2).*L1.*((dt.*L1.^2.*L2.*m2.*(m1+m2).* ...
  x(3).^2.*cos(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*cos(x(1)+(-1).*x(2)) ...
  .*(g.*m1.*cos(x(1))+m2.*(g.*cos(x(1))+L2.*x(4).^2.*cos(x(1)+(-1).* ...
  x(2))))+4.*L1.*L2.^2.*m2.^2.*x(4).*cos(x(1)+(-1).*x(2)).*sin(x(1)+ ...
  (-1).*x(2))+(-1).*dt.*L2.*m2.*sin(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+ ...
  L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1) ...
  .*x(2)))))).*(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+( ...
  -1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.* ...
  sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*( ...
  (-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*( ...
  x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2))+cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*dt.* ...
  L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)) ...
  .*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).* ...
  sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*( ...
  2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.* ...
  m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*( ...
  g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2) ...
  .*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.* ...
  sin(x(2)))))+(2.*dt.*L1.*(L2.^2.*m2.*x(4).^2.*cos(x(1)+(-1).*x(2)) ...
  +g.*L2.*(m1.*cos(x(1))+m2.*cos(x(1)+(-1).*x(2)).*cos(x(2)))+(-1).* ...
  u(2).*sin(x(1)+(-1).*x(2)))+L1.^2.*L2.*m2.*x(3).*(2.*dt.*x(3).*cos( ...
  2.*(x(1)+(-1).*x(2)))+(-8).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).* ...
  x(2)))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.* ...
  L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.*m2.* ...
  cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.* ...
  sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2).*( ...
  u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin( ...
  x(2)))))+32.*g.*L1.^2.*L2.^3.*m2.^2.*cos(x(1)+(-1).*x(2)).*sin( ...
  x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).* ...
  dt.*x(4)+x(2))))+(-1).*m2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).*(16.*L1.^3.*L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2).^2+(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).* ...
  x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin( ...
  x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4) ...
  .*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+( ...
  -1).*x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.* ...
  L2.*m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*(( ...
  -2).*(u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.* ...
  sin(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin( ...
  x(1)+(-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*( ...
  m1+m2).*cos(x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*( ...
  x(3)+(-1).*x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.* ...
  x(4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).* ...
  x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+(-1).*x(2))))))).*sin((1/2).*dt.* ...
  (x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-2).*L1.*((2.*dt.*L2.*((-1).* ...
  u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.* ...
  sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin( ...
  x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+ ...
  (-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*( ...
  m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).* ...
  ((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.* ...
  sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).* ...
  L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+8.*g.*L1.^2.* ...
  L2.^3.*m2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.* ...
  x(4)+x(2)))));

a32=(-1/8).*dt.*L1.^(-4).*L2.^(-3).*cos((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^(-2).*sin(( ...
  1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).^2).^(-2).*(4.*L1.*((-4).* ...
  L1.*L2.^3.*m2.*u(1).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.* ...
  L2.^3.*m2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*g.*L1.^2.* ...
  L2.^3.*m2.*(m1+m2).*sin((1/2).*dt.*x(3)+x(1)).*(m1+m2.*sin(x(1)+( ...
  -1).*x(2)).^2).^2+4.*L1.^2.*L2.^4.*m2.^2.*x(4).^2.*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2))+4.*dt.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*( ...
  L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+ ...
  m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2) ...
  .*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.* ...
  sin(x(2)))))+dt.^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.* ...
  sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+ ...
  L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).* ...
  x(2))+g.*sin(x(2))))).^2)+m2.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(16.*L1.^3.*L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).^2+(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+( ...
  -1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.* ...
  sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*( ...
  (-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*( ...
  x(1)+(-1).*x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.* ...
  L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.* ...
  m2.*((-2).*(u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos( ...
  x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.* ...
  g.*L2.*m2.*(m1+m2).*cos(x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*(( ...
  -4).*m1.*(x(3)+(-1).*x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)) ...
  .^2+4.*x(4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+( ...
  -1).*x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+(-1).*x(2))))))).*sin((1/2) ...
  .*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-2).*L1.*((2.*dt.*L2.*(( ...
  -1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)) ...
  .*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).* ...
  sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.* ...
  m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+( ...
  -1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+ ...
  L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).* ...
  L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+ ...
  8.*g.*L1.^2.*L2.^3.*m2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin(( ...
  1/2).*dt.*x(4)+x(2)))))+(-1/4).*dt.*L1.^(-4).*L2.^(-3).*cos(x(1)+( ...
  -1).*x(2)).*sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .^(-3).*(m1+m2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)) ...
  .^2).^(-1).*(4.*L1.*((-4).*L1.*L2.^3.*m2.*u(1).*(m1+m2.*sin(x(1)+( ...
  -1).*x(2)).^2).^2+4.*L1.*L2.^3.*m2.*u(2).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).^2+4.*g.*L1.^2.*L2.^3.*m2.*(m1+m2).*sin((1/2).*dt.*x(3)+ ...
  x(1)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.^2.*L2.^4.* ...
  m2.^2.*x(4).^2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.*m2.* ...
  x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*(x(3)+(-1) ...
  .*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).* ...
  u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+dt.^2.*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).* ...
  x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+m2.* ...
  cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(16.*L1.^3.* ...
  L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+(2.*dt.*L2.*((-1).* ...
  u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.* ...
  sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin( ...
  x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+ ...
  (-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*(2.*dt.* ...
  L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.* ...
  sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)).*cos( ...
  x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+2.* ...
  g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).* ...
  sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*( ...
  (-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)) ...
  .^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*( ...
  x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1) ...
  .*x(2))+(-2).*L1.*((2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos( ...
  x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*( ...
  m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.* ...
  x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin( ...
  2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.* ...
  sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+ ...
  dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+( ...
  -1).*x(2))+g.*sin(x(2)))))+8.*g.*L1.^2.*L2.^3.*m2.*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*x(4)+x(2)))))+(-1/16).* ...
  dt.*L1.^(-4).*L2.^(-3).*m2.^(-1).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .^(-2).*(m1+m2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)) ...
  .^2).^(-1).*(4.*L1.*(16.*L1.*L2.^3.*m2.^2.*u(1).*cos(x(1)+(-1).* ...
  x(2)).*sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+( ...
  -16).*L1.*L2.^3.*m2.^2.*u(2).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).* ...
  x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+(-16).*g.*L1.^2.*L2.^3.* ...
  m2.^2.*(m1+m2).*cos(x(1)+(-1).*x(2)).*sin((1/2).*dt.*x(3)+x(1)).* ...
  sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+(-4).* ...
  L1.^2.*L2.^4.*m2.^2.*x(4).^2.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+(-16).* ...
  L1.^2.*L2.^4.*m2.^3.*x(4).^2.*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1) ...
  .*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*(x(3)+( ...
  -1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.*m2.*x(4).*(m1+m2.* ...
  sin(x(1)+(-1).*x(2)).^2).*((-1).*L1.*L2.^2.*m2.^2.*x(4).^2.*cos( ...
  x(1)+(-1).*x(2)).^2+(-1).*L1.*L2.*m2.*(m1+m2).*(L1.*x(3).^2.*cos( ...
  x(1)+(-1).*x(2))+g.*cos(x(2)))+L2.*m2.*sin(x(1)+(-1).*x(2)).*((-1) ...
  .*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2))+(-4).*dt.*L1.*L2.^2.*m2.*x(4).*cos((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*(L2.* ...
  m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*( ...
  g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*( ...
  u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin( ...
  x(2)))))+(-8).*dt.*L1.*L2.^2.*m2.^2.*x(4).*cos(x(1)+(-1).*x(2)).* ...
  sin(x(1)+(-1).*x(2)).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.* ...
  sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+ ...
  L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).* ...
  x(2))+g.*sin(x(2)))))+2.*dt.^2.*((-1).*L1.*L2.^2.*m2.^2.*x(4).^2.* ...
  cos(x(1)+(-1).*x(2)).^2+(-1).*L1.*L2.*m2.*(m1+m2).*(L1.*x(3).^2.* ...
  cos(x(1)+(-1).*x(2))+g.*cos(x(2)))+L2.*m2.*sin(x(1)+(-1).*x(2)).*( ...
  (-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.* ...
  sin(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.* ...
  m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2))) ...
  ))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+( ...
  -1).*x(2))+g.*sin(x(2)))))+(-1).*dt.^2.*cos((1/2).*dt.*(x(3)+(-1) ...
  .*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).* ...
  u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+m2.*cos((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*((-64).*L1.^3.*L2.^2.*m2.* ...
  u(2).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+( ...
  -1).*x(2)).^2)+(-1).*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).* ...
  x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin( ...
  x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4) ...
  .*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+( ...
  -1).*x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.* ...
  L2.*m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*(( ...
  -2).*(u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.* ...
  sin(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin( ...
  x(1)+(-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*( ...
  m1+m2).*cos(x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*( ...
  x(3)+(-1).*x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.* ...
  x(4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).* ...
  x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+(-1).*x(2)))))))+(2.*dt.*L2.^2.* ...
  m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.*sin( ...
  x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)).*cos(x(1)+( ...
  -1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+2.*g.*L2.*( ...
  m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*(2.* ...
  dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).*sin(x(1)+( ...
  -1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*((-4).* ...
  x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)).^2+ ...
  dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+( ...
  -1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)) ...
  .*(L1.^2.*L2.*m2.*x(3).*((-2).*dt.*x(3).*cos(2.*(x(1)+(-1).*x(2))) ...
  +8.*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)))+2.*dt.*L1.*((-1).* ...
  L2.^2.*m2.*x(4).^2.*cos(x(1)+(-1).*x(2))+u(2).*sin(x(1)+(-1).*x(2))+ ...
  g.*L2.*((-1).*m2.*cos(x(1)+(-1).*x(2)).*cos(x(2))+(-1).*m2.*sin( ...
  x(1)+(-1).*x(2)).*sin(x(2)))))+(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.* ...
  L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).* ...
  x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.* ...
  x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2)).*((-2).*dt.*L1.^3.*L2.*m2.*(m1+m2).* ...
  x(3).^2.*cos(x(1)+(-1).*x(2))+L1.^2.*((-2).*dt.*g.*L2.*m2.*(m1+m2) ...
  .*cos(x(1)).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.^2.*((-2).*dt.* ...
  x(3).^2.*cos(2.*(x(1)+(-1).*x(2)))+(-2).*dt.*x(4).^2.*cos(2.*( ...
  x(1)+(-1).*x(2)))+8.*x(3).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).* ...
  x(2))+(-8).*x(4).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  dt.*L1.*L2.*m2.*((-2).*L2.^2.*m2.*x(4).^2.*cos(x(1)+(-1).*x(2))+( ...
  -2).*(u(1)+(-2).*u(2)).*sin(x(1)+(-1).*x(2))+2.*g.*L2.*((-1).*m2.*cos( ...
  x(1)+(-1).*x(2)).*cos(x(2))+(-1).*m2.*sin(x(1)+(-1).*x(2)).*sin( ...
  x(2)))))+(-2).*L1.*(8.*g.*L1.^2.*L2.^3.*m2.*cos((1/2).*dt.*x(4)+ ...
  x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+((-1).*dt.*L1.*L2.^2.* ...
  m2.^2.*x(4).^2.*cos(x(1)+(-1).*x(2)).^2+(-1).*dt.*L1.*L2.*m2.*(m1+ ...
  m2).*(L1.*x(3).^2.*cos(x(1)+(-1).*x(2))+g.*cos(x(2)))+(-4).*L1.* ...
  L2.^2.*m2.^2.*x(4).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2))+ ...
  dt.*L2.*m2.*sin(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin( ...
  x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))).*( ...
  2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+ ...
  L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+ ...
  m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+ ...
  m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).* ...
  x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-1) ...
  .*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*dt.*L2.*( ...
  (-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)) ...
  .*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).* ...
  sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*( ...
  2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.* ...
  m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*( ...
  g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2) ...
  .*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.* ...
  sin(x(2)))))+sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*( ...
  2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.* ...
  m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*( ...
  g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2) ...
  .*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.* ...
  sin(x(2))))).*(L1.^2.*L2.*m2.*x(3).*((-2).*dt.*x(3).*cos(2.*(x(1)+ ...
  (-1).*x(2)))+8.*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)))+2.* ...
  dt.*L1.*((-1).*L2.^2.*m2.*x(4).^2.*cos(x(1)+(-1).*x(2))+u(2).*sin( ...
  x(1)+(-1).*x(2))+g.*L2.*((-1).*m2.*cos(x(1)+(-1).*x(2)).*cos(x(2)) ...
  +(-1).*m2.*sin(x(1)+(-1).*x(2)).*sin(x(2)))))+(-32).*g.*L1.^2.* ...
  L2.^3.*m2.^2.*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).*(m1+m2.* ...
  sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*x(4)+x(2))))+m2.*sin(( ...
  1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(16.*L1.^3.*L2.^2.* ...
  u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+(2.*dt.*L2.*((-1).*u(1)+u(2))+ ...
  2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+ ...
  (-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).* ...
  x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)) ...
  .^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*(2.*dt.*L2.^2.*m2.*(( ...
  -1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1) ...
  .*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2)) ...
  +2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin( ...
  x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2) ...
  .*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).*sin(x(1)+(-1).*x(2))+ ...
  L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*((-4).*x(3).*sin(x(1)+ ...
  (-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin( ...
  2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+(-1).*x(2))))))).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-2).*L1.*((2.* ...
  dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.* ...
  m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos( ...
  x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4) ...
  .*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.* ...
  m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+( ...
  -1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+ ...
  L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).* ...
  L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+ ...
  8.*g.*L1.^2.*L2.^3.*m2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin(( ...
  1/2).*dt.*x(4)+x(2)))));


a33=1+(1/16).*dt.^2.*L1.^(-4).*L2.^(-3).*cos((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^(-2).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin(( ...
  1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).^2).^(-2).*(4.*L1.*(( ...
  -4).*L1.*L2.^3.*m2.*u(1).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.* ...
  L1.*L2.^3.*m2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*g.* ...
  L1.^2.*L2.^3.*m2.*(m1+m2).*sin((1/2).*dt.*x(3)+x(1)).*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2+4.*L1.^2.*L2.^4.*m2.^2.*x(4).^2.*(m1+m2.* ...
  sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1) ...
  .*x(2)).^2).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*( ...
  L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+ ...
  m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2) ...
  .*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.* ...
  sin(x(2)))))+dt.^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.* ...
  sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+ ...
  L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).* ...
  x(2))+g.*sin(x(2))))).^2)+m2.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(16.*L1.^3.*L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).^2+(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+( ...
  -1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.* ...
  sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*( ...
  (-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*( ...
  x(1)+(-1).*x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.* ...
  L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.* ...
  m2.*((-2).*(u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos( ...
  x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.* ...
  g.*L2.*m2.*(m1+m2).*cos(x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*(( ...
  -4).*m1.*(x(3)+(-1).*x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)) ...
  .^2+4.*x(4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+( ...
  -1).*x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+(-1).*x(2))))))).*sin((1/2) ...
  .*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-2).*L1.*((2.*dt.*L2.*(( ...
  -1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)) ...
  .*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).* ...
  sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.* ...
  m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+( ...
  -1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+ ...
  L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).* ...
  L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+ ...
  8.*g.*L1.^2.*L2.^3.*m2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin(( ...
  1/2).*dt.*x(4)+x(2)))))+(-1/16).*dt.*L1.^(-4).*L2.^(-3).*m2.^(-1) ...
  .*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^(-2).*(m1+m2.*sin((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).^2).^(-1).*(4.*L1.*(2.*dt.*g.* ...
  L1.^2.*L2.^3.*m2.*(m1+m2).*cos((1/2).*dt.*x(3)+x(1)).*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2+2.*dt.*L1.^2.*L2.^4.*m2.^2.*x(4).^2.*cos(( ...
  1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+( ...
  -1).*x(2)).^2).^2+8.*dt.*L1.^3.*L2.^3.*m2.^2.*(m1+m2).*x(3).* ...
  x(4).*sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin( ...
  (1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+2.*dt.^2.*L1.* ...
  L2.^2.*m2.*x(4).*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)) ...
  .*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*(L2.*m2.*cos(x(1)+(-1).*x(2)) ...
  .*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+4.*dt.^2.* ...
  L1.^2.*L2.*m2.*(m1+m2).*x(3).*sin(x(1)+(-1).*x(2)).*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).* ...
  x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+(1/2).* ...
  dt.^3.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.* ...
  m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*( ...
  g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*( ...
  u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin( ...
  x(2))))).^2)+m2.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)) ...
  .*((1/2).*dt.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*( ...
  2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+ ...
  L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+ ...
  m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+ ...
  m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).* ...
  x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.* ...
  (m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+ ...
  (-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+( ...
  -1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).* ...
  x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos( ...
  x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).* ...
  x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+( ...
  -1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.* ...
  sin(2.*(x(1)+(-1).*x(2)))))))+(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.* ...
  L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).* ...
  x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.* ...
  x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*(4.*dt.*L1.^3.*L2.*m2.*(m1+m2) ...
  .*x(3).*sin(x(1)+(-1).*x(2))+L1.^2.*L2.^2.*m2.*((-4).*m1+m2.*((-4) ...
  .*sin(x(1)+(-1).*x(2)).^2+2.*dt.*x(3).*sin(2.*(x(1)+(-1).*x(2))))) ...
  ).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(dt.*L1.^2.* ...
  L2.*m2.*x(3).*sin(2.*(x(1)+(-1).*x(2)))+L1.^2.*L2.*((-4).*m1+m2.*( ...
  (-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))) ...
  )).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2) ...
  .*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).* ...
  u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).* ...
  x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2)) ...
  ))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)) ...
  .*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+ ...
  m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).* ...
  x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin( ...
  2.*(x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2))+(-2).*L1.*(2.*dt.*L1.^2.*L2.*m2.*(m1+m2).*x(3).*sin( ...
  x(1)+(-1).*x(2)).*(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos( ...
  x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*( ...
  m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.* ...
  x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin( ...
  2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2))+(1/2).*dt.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).* ...
  x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin( ...
  x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4) ...
  .*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+( ...
  -1).*x(2)))))).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.* ...
  m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2))) ...
  ))+dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin( ...
  x(1)+(-1).*x(2))+g.*sin(x(2)))))+(dt.*L1.^2.*L2.*m2.*x(3).*sin(2.* ...
  (x(1)+(-1).*x(2)))+L1.^2.*L2.*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).* ...
  x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+ ...
  m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*(( ...
  -1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.* ...
  sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).* ...
  L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))))+(-1/2).*dt.* ...
  m2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(16.* ...
  L1.^3.*L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+(2.*dt.*L2.* ...
  ((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)) ...
  .*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).* ...
  sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*( ...
  2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)) ...
  .*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2)) ...
  +2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).* ...
  sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*( ...
  (-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)) ...
  .^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*( ...
  x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1) ...
  .*x(2))+(-2).*L1.*((2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos( ...
  x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*( ...
  m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.* ...
  x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin( ...
  2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.* ...
  sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+ ...
  dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+( ...
  -1).*x(2))+g.*sin(x(2)))))+8.*g.*L1.^2.*L2.^3.*m2.*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*x(4)+x(2)))));









a34=(-1/16).*dt.^2.*L1.^(-4).*L2.^(-3).*cos((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^(-2).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin(( ...
  1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).^2).^(-2).*(4.*L1.*(( ...
  -4).*L1.*L2.^3.*m2.*u(1).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.* ...
  L1.*L2.^3.*m2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*g.* ...
  L1.^2.*L2.^3.*m2.*(m1+m2).*sin((1/2).*dt.*x(3)+x(1)).*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2+4.*L1.^2.*L2.^4.*m2.^2.*x(4).^2.*(m1+m2.* ...
  sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1) ...
  .*x(2)).^2).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*( ...
  L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+ ...
  m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2) ...
  .*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.* ...
  sin(x(2)))))+dt.^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.* ...
  sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+ ...
  L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).* ...
  x(2))+g.*sin(x(2))))).^2)+m2.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(16.*L1.^3.*L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).^2+(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+( ...
  -1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.* ...
  sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*( ...
  (-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*( ...
  x(1)+(-1).*x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.* ...
  L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.* ...
  m2.*((-2).*(u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos( ...
  x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.* ...
  g.*L2.*m2.*(m1+m2).*cos(x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*(( ...
  -4).*m1.*(x(3)+(-1).*x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)) ...
  .^2+4.*x(4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+( ...
  -1).*x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+(-1).*x(2))))))).*sin((1/2) ...
  .*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-2).*L1.*((2.*dt.*L2.*(( ...
  -1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)) ...
  .*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).* ...
  sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.* ...
  m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+( ...
  -1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+ ...
  L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).* ...
  L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+ ...
  8.*g.*L1.^2.*L2.^3.*m2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin(( ...
  1/2).*dt.*x(4)+x(2)))))+(-1/16).*dt.*L1.^(-4).*L2.^(-3).*m2.^(-1) ...
  .*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^(-2).*(m1+m2.*sin((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).^2).^(-1).*(4.*L1.*((-2).*dt.* ...
  L1.^2.*L2.^4.*m2.^2.*x(4).^2.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+8.*dt.* ...
  L1.^2.*L2.^4.*m2.^3.*x(4).^2.*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1) ...
  .*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*(x(3)+( ...
  -1).*x(4))+x(1)+(-1).*x(2))+8.*L1.^2.*L2.^4.*m2.^2.*x(4).*(m1+m2.* ...
  sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2))+(-2).*dt.^2.*L1.*L2.^2.*m2.*x(4).*cos((1/2).*dt.* ...
  (x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin( ...
  x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*( ...
  m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2)) ...
  +g.*sin(x(2)))))+4.*dt.^2.*L1.*L2.^2.*m2.^2.*x(4).*cos(x(1)+(-1).* ...
  x(2)).*sin(x(1)+(-1).*x(2)).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.* ...
  (g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).* ...
  x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin( ...
  x(1)+(-1).*x(2))+g.*sin(x(2)))))+4.*dt.*L1.*L2.^2.*m2.*(m1+m2.* ...
  sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.* ...
  m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2))) ...
  ))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+( ...
  -1).*x(2))+g.*sin(x(2)))))+(-1/2).*dt.^3.*cos((1/2).*dt.*(x(3)+( ...
  -1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1) ...
  .*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+m2.*cos((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*((-1/2).*dt.*cos((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*dt.*L2.*((-1).*u(1)+u(2))+ ...
  2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+ ...
  (-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).* ...
  x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)) ...
  .^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*(2.*dt.*L2.^2.*m2.*(( ...
  -1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1) ...
  .*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2)) ...
  +2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin( ...
  x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2) ...
  .*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).*sin(x(1)+(-1).*x(2))+ ...
  L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*((-4).*x(3).*sin(x(1)+ ...
  (-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin( ...
  2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+(-1).*x(2)))))))+( ...
  2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+ ...
  L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+ ...
  m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+ ...
  m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).* ...
  x(2)))))).*(4.*dt.*L1.*L2.^3.*m2.^2.*x(4).*sin(x(1)+(-1).*x(2))+ ...
  L1.^2.*L2.^2.*m2.*(4.*m1+m2.*(4.*sin(x(1)+(-1).*x(2)).^2+2.*dt.* ...
  x(4).*sin(2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.*m2.*x(4).*sin(x(1)+(-1).* ...
  x(2)).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+ ...
  m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2) ...
  .*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).* ...
  x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2)) ...
  ))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)) ...
  .*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+ ...
  m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).* ...
  x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin( ...
  2.*(x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2))+(-2).*L1.*(4.*dt.*g.*L1.^2.*L2.^3.*m2.*cos((1/2).*dt.* ...
  x(4)+x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+(2.*dt.*L1.* ...
  L2.^2.*m2.^2.*x(4).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2))+2.* ...
  L1.*L2.^2.*m2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)).*(2.*dt.*L2.*(( ...
  -1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)) ...
  .*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).* ...
  sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-1/2).*dt.*cos( ...
  (1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*dt.*L2.*((-1).* ...
  u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.* ...
  sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin( ...
  x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+ ...
  (-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*(2.*L1.* ...
  L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.*m2.*cos( ...
  x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin( ...
  x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+( ...
  -1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)) ...
  )))+4.*dt.*L1.*L2.^2.*m2.*x(4).*sin(x(1)+(-1).*x(2)).*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*( ...
  m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).* ...
  ((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.* ...
  sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).* ...
  L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))))+(1/2).*dt.* ...
  m2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(16.* ...
  L1.^3.*L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+(2.*dt.*L2.* ...
  ((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)) ...
  .*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).* ...
  sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*( ...
  2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)) ...
  .*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2)) ...
  +2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).* ...
  sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*( ...
  (-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)) ...
  .^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*( ...
  x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1) ...
  .*x(2))+(-2).*L1.*((2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos( ...
  x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*( ...
  m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.* ...
  x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin( ...
  2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.* ...
  sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+ ...
  dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+( ...
  -1).*x(2))+g.*sin(x(2)))))+8.*g.*L1.^2.*L2.^3.*m2.*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*x(4)+x(2)))));

%%%%%%%%%%%%%%%%%%%%%

a41=(1/16).*dt.*L1.^(-3).*L2.^(-4).*m2.^(-1).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).^(-2).*(m1+m2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).^2).^(-1).*(4.*L1.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*((-16).*L1.*L2.^3.*m2.^2.*u(1).*cos(x(1)+(-1).* ...
  x(2)).*sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+16.* ...
  L1.*L2.^3.*m2.^2.*u(2).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).* ...
  (m1+m2.*sin(x(1)+(-1).*x(2)).^2)+16.*g.*L1.^2.*L2.^3.*m2.^2.*(m1+ ...
  m2).*cos(x(1)+(-1).*x(2)).*sin((1/2).*dt.*x(3)+x(1)).*sin(x(1)+( ...
  -1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+4.*g.*L1.^2.*L2.^3.* ...
  m2.*(m1+m2).*cos((1/2).*dt.*x(3)+x(1)).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).^2+4.*L1.^2.*L2.^4.*m2.^2.*x(4).^2.*cos((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2).^2+16.*L1.^2.*L2.^4.*m2.^3.*x(4).^2.*cos(x(1)+(-1).*x(2)).* ...
  sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2) ...
  .*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.*m2.* ...
  x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*(L1.^2.*L2.*m2.*(m1+m2).* ...
  x(3).^2.*cos(x(1)+(-1).*x(2))+L1.*L2.*m2.*cos(x(1)+(-1).*x(2)).*( ...
  g.*m1.*cos(x(1))+m2.*(g.*cos(x(1))+L2.*x(4).^2.*cos(x(1)+(-1).* ...
  x(2))))+(-1).*L2.*m2.*sin(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.* ...
  m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2))) ...
  ))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.* ...
  L2.^2.*m2.*x(4).*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)) ...
  .*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*(L2.*m2.*cos(x(1)+(-1).*x(2)) ...
  .*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+8.*dt.*L1.* ...
  L2.^2.*m2.^2.*x(4).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos( ...
  x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin( ...
  x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).* ...
  L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+ ...
  2.*dt.^2.*(L1.^2.*L2.*m2.*(m1+m2).*x(3).^2.*cos(x(1)+(-1).*x(2))+ ...
  L1.*L2.*m2.*cos(x(1)+(-1).*x(2)).*(g.*m1.*cos(x(1))+m2.*(g.*cos( ...
  x(1))+L2.*x(4).^2.*cos(x(1)+(-1).*x(2))))+(-1).*L2.*m2.*sin(x(1)+( ...
  -1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+ ...
  L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+ ...
  u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+( ...
  -1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.* ...
  sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+dt.^2.*cos((1/2).*dt.*(x(3)+( ...
  -1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1) ...
  .*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+(-4).*L1.*sin(( ...
  1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*((-4).*L1.*L2.^3.* ...
  m2.*u(1).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.*L2.^3.*m2.*u(2).* ...
  (m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*g.*L1.^2.*L2.^3.*m2.*(m1+ ...
  m2).*sin((1/2).*dt.*x(3)+x(1)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .^2+4.*L1.^2.*L2.^4.*m2.^2.*x(4).^2.*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2).^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.* ...
  L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).* ...
  x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+dt.^2.*sin( ...
  (1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+( ...
  -1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+ ...
  L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.* ...
  m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+( ...
  m1+m2).*(64.*L1.^3.*L2.^2.*m2.*u(2).*cos(x(1)+(-1).*x(2)).*sin(x(1)+ ...
  (-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+cos((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*dt.*L2.*((-1).*u(1)+u(2))+2.* ...
  dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+( ...
  -1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).* ...
  x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)) ...
  .^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*(2.*dt.*L2.^2.*m2.*(( ...
  -1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1) ...
  .*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2)) ...
  +2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin( ...
  x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2) ...
  .*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).*sin(x(1)+(-1).*x(2))+ ...
  L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*((-4).*x(3).*sin(x(1)+ ...
  (-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin( ...
  2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+(-1).*x(2)))))))+( ...
  2.*dt.*L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.*cos(x(1)+(-1).*x(2))+dt.* ...
  L1.*L2.*m2.*(2.*L2.^2.*m2.*x(4).^2.*cos(x(1)+(-1).*x(2))+2.*g.* ...
  L2.*(m1.*cos(x(1))+m2.*cos(x(1)+(-1).*x(2)).*cos(x(2)))+2.*(u(1)+( ...
  -2).*u(2)).*sin(x(1)+(-1).*x(2)))+L1.^2.*(2.*dt.*g.*L2.*m2.*(m1+m2) ...
  .*cos(x(1)).*cos(x(1)+(-1).*x(2))+(-2).*dt.*g.*L2.*m2.*(m1+m2).* ...
  sin(x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.^2.*(2.*dt.*x(3).^2.* ...
  cos(2.*(x(1)+(-1).*x(2)))+2.*dt.*x(4).^2.*cos(2.*(x(1)+(-1).*x(2)) ...
  )+(-8).*x(3).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2))+8.*x(4).* ...
  cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2))))).*(2.*dt.*L2.*((-1).* ...
  u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.* ...
  sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin( ...
  x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+ ...
  (-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(2.*dt.*L1.*(L2.^2.*m2.* ...
  x(4).^2.*cos(x(1)+(-1).*x(2))+g.*L2.*(m1.*cos(x(1))+m2.*cos(x(1)+( ...
  -1).*x(2)).*cos(x(2)))+(-1).*u(2).*sin(x(1)+(-1).*x(2)))+L1.^2.*L2.* ...
  m2.*x(3).*(2.*dt.*x(3).*cos(2.*(x(1)+(-1).*x(2)))+(-8).*cos(x(1)+( ...
  -1).*x(2)).*sin(x(1)+(-1).*x(2)))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+ ...
  u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+ ...
  dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.* ...
  L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+ ...
  m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+ ...
  2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.* ...
  m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).* ...
  x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin(2.*( ...
  x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+(-1).*x(2))))))).*sin( ...
  (1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-2).*L1.*((dt.* ...
  L1.^2.*L2.*m2.*(m1+m2).*x(3).^2.*cos(x(1)+(-1).*x(2))+dt.*L1.*L2.* ...
  m2.*cos(x(1)+(-1).*x(2)).*(g.*m1.*cos(x(1))+m2.*(g.*cos(x(1))+L2.* ...
  x(4).^2.*cos(x(1)+(-1).*x(2))))+4.*L1.*L2.^2.*m2.^2.*x(4).*cos( ...
  x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2))+(-1).*dt.*L2.*m2.*sin(x(1)+ ...
  (-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+ ...
  L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))).*(2.*dt.*L2.*((-1).*u(1)+u(2))+ ...
  2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+ ...
  (-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).* ...
  x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)) ...
  .^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+( ...
  -1).*x(4))+x(1)+(-1).*x(2))+cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+ ...
  (-1).*x(2)).*(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+( ...
  -1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.* ...
  sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*( ...
  (-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*( ...
  x(1)+(-1).*x(2)))))).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+( ...
  -1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.* ...
  (g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).* ...
  x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.* ...
  sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+(2.*dt.*L1.*(L2.^2.*m2.* ...
  x(4).^2.*cos(x(1)+(-1).*x(2))+g.*L2.*(m1.*cos(x(1))+m2.*cos(x(1)+( ...
  -1).*x(2)).*cos(x(2)))+(-1).*u(2).*sin(x(1)+(-1).*x(2)))+L1.^2.*L2.* ...
  m2.*x(3).*(2.*dt.*x(3).*cos(2.*(x(1)+(-1).*x(2)))+(-8).*cos(x(1)+( ...
  -1).*x(2)).*sin(x(1)+(-1).*x(2)))).*sin((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+ ...
  (-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+ ...
  L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1) ...
  .*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.* ...
  sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+32.*g.*L1.^2.*L2.^3.*m2.^2.* ...
  cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1) ...
  .*x(2)).^2).*sin((1/2).*dt.*x(4)+x(2)))))+(-1/8).*dt.*L1.^(-3).* ...
  L2.^(-4).*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+ ...
  m2.*sin(x(1)+(-1).*x(2)).^2).^(-2).*sin((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).^2).^(-2).*(4.*L1.*cos((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2)).*((-4).*L1.*L2.^3.*m2.*u(1).*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2+4.*L1.*L2.^3.*m2.*u(2).*(m1+m2.*sin(x(1)+( ...
  -1).*x(2)).^2).^2+4.*g.*L1.^2.*L2.^3.*m2.*(m1+m2).*sin((1/2).*dt.* ...
  x(3)+x(1)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.^2.*L2.^4.* ...
  m2.^2.*x(4).^2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.*m2.* ...
  x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*(x(3)+(-1) ...
  .*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).* ...
  u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+dt.^2.*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).* ...
  x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+(m1+m2) ...
  .*(16.*L1.^3.*L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+(2.* ...
  dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.* ...
  m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos( ...
  x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4) ...
  .*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).* ...
  (2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)) ...
  .*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2)) ...
  +2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).* ...
  sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*( ...
  (-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)) ...
  .^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*( ...
  x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1) ...
  .*x(2))+(-2).*L1.*((2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos( ...
  x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*( ...
  m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.* ...
  x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin( ...
  2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.* ...
  sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+ ...
  dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+( ...
  -1).*x(2))+g.*sin(x(2)))))+8.*g.*L1.^2.*L2.^3.*m2.*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*x(4)+x(2)))))+(-1/4).*dt.* ...
  L1.^(-3).*L2.^(-4).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).*( ...
  m1+m2.*sin(x(1)+(-1).*x(2)).^2).^(-3).*(m1+m2.*sin((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).^2).^(-1).*(4.*L1.*cos((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*((-4).*L1.*L2.^3.*m2.*u(1).* ...
  (m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.*L2.^3.*m2.*u(2).*(m1+m2.* ...
  sin(x(1)+(-1).*x(2)).^2).^2+4.*g.*L1.^2.*L2.^3.*m2.*(m1+m2).*sin(( ...
  1/2).*dt.*x(3)+x(1)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.* ...
  L1.^2.*L2.^4.*m2.^2.*x(4).^2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.* ...
  L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.* ...
  (x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)) ...
  .*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+dt.^2.*sin( ...
  (1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+( ...
  -1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+ ...
  L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.* ...
  m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+( ...
  m1+m2).*(16.*L1.^3.*L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .^2+(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2)) ...
  +L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+ ...
  m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+ ...
  m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).* ...
  x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.* ...
  (m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+ ...
  (-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+( ...
  -1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).* ...
  x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos( ...
  x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).* ...
  x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+( ...
  -1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.* ...
  sin(2.*(x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2))+(-2).*L1.*((2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*( ...
  u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+ ...
  g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.* ...
  x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+ ...
  (-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+ ...
  L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1) ...
  .*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.* ...
  sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+8.*g.*L1.^2.*L2.^3.*m2.*(m1+ ...
  m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*x(4)+x(2)))));

a42=(1/16).*dt.*L1.^(-3).*L2.^(-4).*m2.^(-1).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).^(-2).*(m1+m2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).^2).^(-1).*(4.*L1.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(16.*L1.*L2.^3.*m2.^2.*u(1).*cos(x(1)+(-1).*x(2)) ...
  .*sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+(-16).* ...
  L1.*L2.^3.*m2.^2.*u(2).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).* ...
  (m1+m2.*sin(x(1)+(-1).*x(2)).^2)+(-16).*g.*L1.^2.*L2.^3.*m2.^2.*( ...
  m1+m2).*cos(x(1)+(-1).*x(2)).*sin((1/2).*dt.*x(3)+x(1)).*sin(x(1)+ ...
  (-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+(-4).*L1.^2.*L2.^4.* ...
  m2.^2.*x(4).^2.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)) ...
  .*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+(-16).*L1.^2.*L2.^4.*m2.^3.* ...
  x(4).^2.*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2))+4.*dt.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .*((-1).*L1.*L2.^2.*m2.^2.*x(4).^2.*cos(x(1)+(-1).*x(2)).^2+(-1).* ...
  L1.*L2.*m2.*(m1+m2).*(L1.*x(3).^2.*cos(x(1)+(-1).*x(2))+g.*cos( ...
  x(2)))+L2.*m2.*sin(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin( ...
  x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-4).*dt.*L1.* ...
  L2.^2.*m2.*x(4).*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)) ...
  .*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*(L2.*m2.*cos(x(1)+(-1).*x(2)) ...
  .*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+(-8).*dt.* ...
  L1.*L2.^2.*m2.^2.*x(4).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)) ...
  .*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos( ...
  x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin( ...
  x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).* ...
  L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+ ...
  2.*dt.^2.*((-1).*L1.*L2.^2.*m2.^2.*x(4).^2.*cos(x(1)+(-1).*x(2)) ...
  .^2+(-1).*L1.*L2.*m2.*(m1+m2).*(L1.*x(3).^2.*cos(x(1)+(-1).*x(2))+ ...
  g.*cos(x(2)))+L2.*m2.*sin(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.* ...
  m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2))) ...
  ))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.* ...
  cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.* ...
  sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+( ...
  -1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)) ...
  )))+(-1).*dt.^2.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)) ...
  .*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin( ...
  x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*( ...
  m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2)) ...
  +g.*sin(x(2))))).^2)+4.*L1.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+ ...
  (-1).*x(2)).*((-4).*L1.*L2.^3.*m2.*u(1).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).^2+4.*L1.*L2.^3.*m2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2).^2+4.*g.*L1.^2.*L2.^3.*m2.*(m1+m2).*sin((1/2).*dt.*x(3)+x(1)) ...
  .*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.^2.*L2.^4.*m2.^2.* ...
  x(4).^2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.*m2.*x(4).*(m1+ ...
  m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.* ...
  (g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).* ...
  x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin( ...
  x(1)+(-1).*x(2))+g.*sin(x(2)))))+dt.^2.*sin((1/2).*dt.*(x(3)+(-1) ...
  .*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).* ...
  u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+(m1+m2).*((-64) ...
  .*L1.^3.*L2.^2.*m2.*u(2).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)) ...
  .*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+(-1).*cos((1/2).*dt.*(x(3)+(-1) ...
  .*x(4))+x(1)+(-1).*x(2)).*(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*( ...
  u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+ ...
  g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.* ...
  x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+ ...
  u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+ ...
  dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.* ...
  L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+ ...
  m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+ ...
  2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.* ...
  m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).* ...
  x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin(2.*( ...
  x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+(-1).*x(2)))))))+(2.* ...
  dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)) ...
  .*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2)) ...
  +2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).* ...
  sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*( ...
  (-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)) ...
  .^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*( ...
  x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1) ...
  .*x(2)).*(L1.^2.*L2.*m2.*x(3).*((-2).*dt.*x(3).*cos(2.*(x(1)+(-1) ...
  .*x(2)))+8.*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)))+2.*dt.* ...
  L1.*((-1).*L2.^2.*m2.*x(4).^2.*cos(x(1)+(-1).*x(2))+u(2).*sin(x(1)+( ...
  -1).*x(2))+g.*L2.*((-1).*m2.*cos(x(1)+(-1).*x(2)).*cos(x(2))+(-1) ...
  .*m2.*sin(x(1)+(-1).*x(2)).*sin(x(2)))))+(2.*dt.*L2.*((-1).*u(1)+u(2)) ...
  +2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+( ...
  -1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).* ...
  x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*((-2).*dt.*L1.^3.*L2.*m2.*(m1+ ...
  m2).*x(3).^2.*cos(x(1)+(-1).*x(2))+L1.^2.*((-2).*dt.*g.*L2.*m2.*( ...
  m1+m2).*cos(x(1)).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.^2.*((-2).*dt.* ...
  x(3).^2.*cos(2.*(x(1)+(-1).*x(2)))+(-2).*dt.*x(4).^2.*cos(2.*( ...
  x(1)+(-1).*x(2)))+8.*x(3).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).* ...
  x(2))+(-8).*x(4).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  dt.*L1.*L2.*m2.*((-2).*L2.^2.*m2.*x(4).^2.*cos(x(1)+(-1).*x(2))+( ...
  -2).*(u(1)+(-2).*u(2)).*sin(x(1)+(-1).*x(2))+2.*g.*L2.*((-1).*m2.*cos( ...
  x(1)+(-1).*x(2)).*cos(x(2))+(-1).*m2.*sin(x(1)+(-1).*x(2)).*sin( ...
  x(2)))))+(-2).*L1.*(8.*g.*L1.^2.*L2.^3.*m2.*cos((1/2).*dt.*x(4)+ ...
  x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+((-1).*dt.*L1.*L2.^2.* ...
  m2.^2.*x(4).^2.*cos(x(1)+(-1).*x(2)).^2+(-1).*dt.*L1.*L2.*m2.*(m1+ ...
  m2).*(L1.*x(3).^2.*cos(x(1)+(-1).*x(2))+g.*cos(x(2)))+(-4).*L1.* ...
  L2.^2.*m2.^2.*x(4).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2))+ ...
  dt.*L2.*m2.*sin(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin( ...
  x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))).*( ...
  2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+ ...
  L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+ ...
  m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+ ...
  m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).* ...
  x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-1) ...
  .*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*dt.*L2.*( ...
  (-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)) ...
  .*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).* ...
  sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*( ...
  2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.* ...
  m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*( ...
  g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2) ...
  .*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.* ...
  sin(x(2)))))+sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*( ...
  2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.* ...
  m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*( ...
  g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2) ...
  .*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.* ...
  sin(x(2))))).*(L1.^2.*L2.*m2.*x(3).*((-2).*dt.*x(3).*cos(2.*(x(1)+ ...
  (-1).*x(2)))+8.*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)))+2.* ...
  dt.*L1.*((-1).*L2.^2.*m2.*x(4).^2.*cos(x(1)+(-1).*x(2))+u(2).*sin( ...
  x(1)+(-1).*x(2))+g.*L2.*((-1).*m2.*cos(x(1)+(-1).*x(2)).*cos(x(2)) ...
  +(-1).*m2.*sin(x(1)+(-1).*x(2)).*sin(x(2)))))+(-32).*g.*L1.^2.* ...
  L2.^3.*m2.^2.*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).*(m1+m2.* ...
  sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*x(4)+x(2)))))+(1/8).*dt.* ...
  L1.^(-3).*L2.^(-4).*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^(-2).*sin((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin((1/2).*dt.*(x(3)+( ...
  -1).*x(4))+x(1)+(-1).*x(2)).^2).^(-2).*(4.*L1.*cos((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*((-4).*L1.*L2.^3.*m2.*u(1).*(m1+ ...
  m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.*L2.^3.*m2.*u(2).*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2+4.*g.*L1.^2.*L2.^3.*m2.*(m1+m2).*sin((1/2) ...
  .*dt.*x(3)+x(1)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.^2.* ...
  L2.^4.*m2.^2.*x(4).^2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin(( ...
  1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.* ...
  m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*(x(3)+( ...
  -1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1) ...
  .*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+dt.^2.*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).* ...
  x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+(m1+m2) ...
  .*(16.*L1.^3.*L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+(2.* ...
  dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.* ...
  m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos( ...
  x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4) ...
  .*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).* ...
  (2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)) ...
  .*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2)) ...
  +2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).* ...
  sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*( ...
  (-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)) ...
  .^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*( ...
  x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1) ...
  .*x(2))+(-2).*L1.*((2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos( ...
  x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*( ...
  m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.* ...
  x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin( ...
  2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.* ...
  sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+ ...
  dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+( ...
  -1).*x(2))+g.*sin(x(2)))))+8.*g.*L1.^2.*L2.^3.*m2.*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*x(4)+x(2)))))+(1/4).*dt.* ...
  L1.^(-3).*L2.^(-4).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).*( ...
  m1+m2.*sin(x(1)+(-1).*x(2)).^2).^(-3).*(m1+m2.*sin((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).^2).^(-1).*(4.*L1.*cos((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*((-4).*L1.*L2.^3.*m2.*u(1).* ...
  (m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.*L2.^3.*m2.*u(2).*(m1+m2.* ...
  sin(x(1)+(-1).*x(2)).^2).^2+4.*g.*L1.^2.*L2.^3.*m2.*(m1+m2).*sin(( ...
  1/2).*dt.*x(3)+x(1)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.* ...
  L1.^2.*L2.^4.*m2.^2.*x(4).^2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.* ...
  L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.* ...
  (x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)) ...
  .*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+dt.^2.*sin( ...
  (1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+( ...
  -1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+ ...
  L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.* ...
  m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+( ...
  m1+m2).*(16.*L1.^3.*L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .^2+(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2)) ...
  +L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+ ...
  m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+ ...
  m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).* ...
  x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.* ...
  (m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+ ...
  (-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+( ...
  -1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).* ...
  x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos( ...
  x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).* ...
  x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+( ...
  -1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.* ...
  sin(2.*(x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2))+(-2).*L1.*((2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*( ...
  u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+ ...
  g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.* ...
  x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+ ...
  (-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+ ...
  L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1) ...
  .*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.* ...
  sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+8.*g.*L1.^2.*L2.^3.*m2.*(m1+ ...
  m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*x(4)+x(2)))));


a43=(1/16).*dt.*L1.^(-3).*L2.^(-4).*m2.^(-1).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2).^(-2).*(m1+m2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).^2).^(-1).*(4.*L1.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(2.*dt.*g.*L1.^2.*L2.^3.*m2.*(m1+m2).*cos((1/2) ...
  .*dt.*x(3)+x(1)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+2.*dt.* ...
  L1.^2.*L2.^4.*m2.^2.*x(4).^2.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+8.*dt.* ...
  L1.^3.*L2.^3.*m2.^2.*(m1+m2).*x(3).*x(4).*sin(x(1)+(-1).*x(2)).*( ...
  m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2))+2.*dt.^2.*L1.*L2.^2.*m2.*x(4).*cos((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin( ...
  x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*( ...
  m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2)) ...
  +g.*sin(x(2)))))+4.*dt.^2.*L1.^2.*L2.*m2.*(m1+m2).*x(3).*sin(x(1)+ ...
  (-1).*x(2)).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*( ...
  L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+ ...
  m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2) ...
  .*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.* ...
  sin(x(2)))))+(1/2).*dt.^3.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.* ...
  m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2))) ...
  ))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+( ...
  -1).*x(2))+g.*sin(x(2))))).^2)+(-2).*dt.*L1.*sin((1/2).*dt.*(x(3)+ ...
  (-1).*x(4))+x(1)+(-1).*x(2)).*((-4).*L1.*L2.^3.*m2.*u(1).*(m1+m2.* ...
  sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.*L2.^3.*m2.*u(2).*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).^2+4.*g.*L1.^2.*L2.^3.*m2.*(m1+m2).*sin((1/2) ...
  .*dt.*x(3)+x(1)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.^2.* ...
  L2.^4.*m2.^2.*x(4).^2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin(( ...
  1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.* ...
  m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*(x(3)+( ...
  -1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1) ...
  .*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+dt.^2.*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).* ...
  x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+(m1+m2) ...
  .*((1/2).*dt.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*( ...
  2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+ ...
  L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+ ...
  m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+ ...
  m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).* ...
  x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.* ...
  (m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+ ...
  (-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+( ...
  -1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).* ...
  x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos( ...
  x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).* ...
  x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+( ...
  -1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.* ...
  sin(2.*(x(1)+(-1).*x(2)))))))+(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.* ...
  L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).* ...
  x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.* ...
  x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*(4.*dt.*L1.^3.*L2.*m2.*(m1+m2) ...
  .*x(3).*sin(x(1)+(-1).*x(2))+L1.^2.*L2.^2.*m2.*((-4).*m1+m2.*((-4) ...
  .*sin(x(1)+(-1).*x(2)).^2+2.*dt.*x(3).*sin(2.*(x(1)+(-1).*x(2))))) ...
  ).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(dt.*L1.^2.* ...
  L2.*m2.*x(3).*sin(2.*(x(1)+(-1).*x(2)))+L1.^2.*L2.*((-4).*m1+m2.*( ...
  (-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))) ...
  )).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2) ...
  .*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).* ...
  u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).* ...
  x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2)) ...
  ))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)) ...
  .*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+ ...
  m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).* ...
  x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin( ...
  2.*(x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2))+(-2).*L1.*(2.*dt.*L1.^2.*L2.*m2.*(m1+m2).*x(3).*sin( ...
  x(1)+(-1).*x(2)).*(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos( ...
  x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*( ...
  m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.* ...
  x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin( ...
  2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2))+(1/2).*dt.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).* ...
  x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin( ...
  x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4) ...
  .*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+( ...
  -1).*x(2)))))).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.* ...
  m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2))) ...
  ))+dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin( ...
  x(1)+(-1).*x(2))+g.*sin(x(2)))))+(dt.*L1.^2.*L2.*m2.*x(3).*sin(2.* ...
  (x(1)+(-1).*x(2)))+L1.^2.*L2.*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).* ...
  x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+ ...
  m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*(( ...
  -1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.* ...
  sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).* ...
  L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))))))+(-1/16).* ...
  dt.^2.*L1.^(-3).*L2.^(-4).*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^(-2).*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin((1/2).*dt.*( ...
  x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).^2).^(-2).*(4.*L1.*cos((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*((-4).*L1.*L2.^3.*m2.*u(1).* ...
  (m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.*L2.^3.*m2.*u(2).*(m1+m2.* ...
  sin(x(1)+(-1).*x(2)).^2).^2+4.*g.*L1.^2.*L2.^3.*m2.*(m1+m2).*sin(( ...
  1/2).*dt.*x(3)+x(1)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.* ...
  L1.^2.*L2.^4.*m2.^2.*x(4).^2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.* ...
  L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.* ...
  (x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)) ...
  .*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+dt.^2.*sin( ...
  (1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+( ...
  -1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+ ...
  L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.* ...
  m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+( ...
  m1+m2).*(16.*L1.^3.*L2.^2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .^2+(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2)) ...
  +L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+ ...
  m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+ ...
  m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).* ...
  x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.* ...
  (m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+ ...
  (-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+( ...
  -1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).* ...
  x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos( ...
  x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).* ...
  x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+( ...
  -1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.* ...
  sin(2.*(x(1)+(-1).*x(2))))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2))+(-2).*L1.*((2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*( ...
  u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+ ...
  g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.* ...
  x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+ ...
  (-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+ ...
  L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1) ...
  .*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.* ...
  sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+8.*g.*L1.^2.*L2.^3.*m2.*(m1+ ...
  m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*x(4)+x(2)))));



a44=1+(1/16).*dt.*L1.^(-3).*L2.^(-4).*m2.^(-1).*(m1+m2.*sin(x(1)+(-1) ...
  .*x(2)).^2).^(-2).*(m1+m2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2)).^2).^(-1).*(4.*L1.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*((-2).*dt.*L1.^2.*L2.^4.*m2.^2.*x(4).^2.*cos(( ...
  1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+( ...
  -1).*x(2)).^2).^2+8.*dt.*L1.^2.*L2.^4.*m2.^3.*x(4).^2.*cos(x(1)+( ...
  -1).*x(2)).*sin(x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+8.*L1.^2.* ...
  L2.^4.*m2.^2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2) ...
  .*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-2).*dt.^2.*L1.*L2.^2.* ...
  m2.*x(4).*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+ ...
  m2.*sin(x(1)+(-1).*x(2)).^2).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1) ...
  .*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin( ...
  x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.* ...
  x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+4.*dt.^2.*L1.* ...
  L2.^2.*m2.^2.*x(4).*cos(x(1)+(-1).*x(2)).*sin(x(1)+(-1).*x(2)).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos( ...
  x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin( ...
  x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).* ...
  L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+ ...
  4.*dt.*L1.*L2.^2.*m2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).*sin((1/2) ...
  .*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).* ...
  x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*(( ...
  -1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+(-1/2).* ...
  dt.^3.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(L2.* ...
  m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*( ...
  g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2).*( ...
  u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin( ...
  x(2))))).^2)+2.*dt.*L1.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1) ...
  .*x(2)).*((-4).*L1.*L2.^3.*m2.*u(1).*(m1+m2.*sin(x(1)+(-1).*x(2)) ...
  .^2).^2+4.*L1.*L2.^3.*m2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+ ...
  4.*g.*L1.^2.*L2.^3.*m2.*(m1+m2).*sin((1/2).*dt.*x(3)+x(1)).*(m1+ ...
  m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.^2.*L2.^4.*m2.^2.*x(4).^2.*( ...
  m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*(x(3)+(-1).* ...
  x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin( ...
  x(1)+(-1).*x(2)).^2).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.* ...
  sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+ ...
  L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).* ...
  x(2))+g.*sin(x(2)))))+dt.^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.* ...
  (g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).* ...
  x(2)))))+L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin( ...
  x(1)+(-1).*x(2))+g.*sin(x(2))))).^2)+(m1+m2).*((-1/2).*dt.*cos(( ...
  1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*dt.*L2.*((-1).* ...
  u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.* ...
  sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin( ...
  x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+ ...
  (-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*(2.*dt.* ...
  L2.^2.*m2.*((-1).*u(1)+u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.* ...
  sin(x(1)+(-1).*x(2))+dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)).*cos( ...
  x(1)+(-1).*x(2))+2.*L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+2.* ...
  g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).* ...
  sin(x(1)+(-1).*x(2))+L2.^2.*m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*( ...
  (-4).*x(3).*sin(x(1)+(-1).*x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)) ...
  .^2+dt.*x(3).^2.*sin(2.*(x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*( ...
  x(1)+(-1).*x(2)))))))+(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).* ...
  cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.* ...
  L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.* ...
  L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).* ...
  sin(2.*(x(1)+(-1).*x(2)))))).*(4.*dt.*L1.*L2.^3.*m2.^2.*x(4).*sin( ...
  x(1)+(-1).*x(2))+L1.^2.*L2.^2.*m2.*(4.*m1+m2.*(4.*sin(x(1)+(-1).* ...
  x(2)).^2+2.*dt.*x(4).*sin(2.*(x(1)+(-1).*x(2)))))).*sin((1/2).* ...
  dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.*m2.* ...
  x(4).*sin(x(1)+(-1).*x(2)).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+u(2))+2.* ...
  dt.*L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+dt.*L1.* ...
  L2.*m2.*((-2).*(u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.*L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+m2.*cos( ...
  x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+2.*dt.* ...
  g.*L2.*m2.*(m1+m2).*cos(x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.*m2.*(( ...
  -4).*m1.*(x(3)+(-1).*x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).*x(2)) ...
  .^2+4.*x(4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin(2.*(x(1)+( ...
  -1).*x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+(-1).*x(2))))))).*sin((1/2) ...
  .*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-2).*L1.*(4.*dt.*g.* ...
  L1.^2.*L2.^3.*m2.*cos((1/2).*dt.*x(4)+x(2)).*(m1+m2.*sin(x(1)+(-1) ...
  .*x(2)).^2).^2+(2.*dt.*L1.*L2.^2.*m2.^2.*x(4).*cos(x(1)+(-1).* ...
  x(2)).*sin(x(1)+(-1).*x(2))+2.*L1.*L2.^2.*m2.*(m1+m2.*sin(x(1)+( ...
  -1).*x(2)).^2)).*(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos( ...
  x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*( ...
  m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.* ...
  x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin( ...
  2.*(x(1)+(-1).*x(2)))))).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+( ...
  -1).*x(2))+(-1/2).*dt.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1) ...
  .*x(2)).*(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).* ...
  x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin( ...
  x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4) ...
  .*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+( ...
  -1).*x(2)))))).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).* ...
  x(2)).^2)+dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.* ...
  m1.*sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2))) ...
  ))+dt.*L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin( ...
  x(1)+(-1).*x(2))+g.*sin(x(2)))))+4.*dt.*L1.*L2.^2.*m2.*x(4).*sin( ...
  x(1)+(-1).*x(2)).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*(2.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+ ...
  dt.*L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin( ...
  x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.* ...
  L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).* ...
  x(2))+g.*sin(x(2))))))))+(1/16).*dt.^2.*L1.^(-3).*L2.^(-4).*cos(( ...
  1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(m1+m2.*sin(x(1)+( ...
  -1).*x(2)).^2).^(-2).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*(m1+m2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)) ...
  .^2).^(-2).*(4.*L1.*cos((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*((-4).*L1.*L2.^3.*m2.*u(1).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2) ...
  .^2+4.*L1.*L2.^3.*m2.*u(2).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2+4.* ...
  g.*L1.^2.*L2.^3.*m2.*(m1+m2).*sin((1/2).*dt.*x(3)+x(1)).*(m1+m2.* ...
  sin(x(1)+(-1).*x(2)).^2).^2+4.*L1.^2.*L2.^4.*m2.^2.*x(4).^2.*(m1+ ...
  m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+ ...
  x(1)+(-1).*x(2))+4.*dt.*L1.*L2.^2.*m2.*x(4).*(m1+m2.*sin(x(1)+(-1) ...
  .*x(2)).^2).*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*( ...
  L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+ ...
  m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+L1.*(m1+m2) ...
  .*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.* ...
  sin(x(2)))))+dt.^2.*sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).* ...
  x(2)).*(L2.*m2.*cos(x(1)+(-1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.* ...
  sin(x(1))+m2.*(g.*sin(x(1))+L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+ ...
  L1.*(m1+m2).*(u(2)+(-1).*L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).* ...
  x(2))+g.*sin(x(2))))).^2)+(m1+m2).*(16.*L1.^3.*L2.^2.*u(2).*(m1+m2.* ...
  sin(x(1)+(-1).*x(2)).^2).^2+(2.*dt.*L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*( ...
  u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+ ...
  g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+ ...
  L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).*sin(x(1)+(-1).*x(2)).^2+dt.* ...
  x(3).*sin(2.*(x(1)+(-1).*x(2)))))).*(2.*dt.*L2.^2.*m2.*((-1).*u(1)+ ...
  u(2))+2.*dt.*L1.^3.*L2.*m2.*(m1+m2).*x(3).^2.*sin(x(1)+(-1).*x(2))+ ...
  dt.*L1.*L2.*m2.*((-2).*(u(1)+(-2).*u(2)).*cos(x(1)+(-1).*x(2))+2.* ...
  L2.^2.*m2.*x(4).^2.*sin(x(1)+(-1).*x(2))+2.*g.*L2.*(m1.*sin(x(1))+ ...
  m2.*cos(x(2)).*sin(x(1)+(-1).*x(2))))+L1.^2.*(2.*dt.*(m1+m2).*u(2)+ ...
  2.*dt.*g.*L2.*m2.*(m1+m2).*cos(x(1)).*sin(x(1)+(-1).*x(2))+L2.^2.* ...
  m2.*((-4).*m1.*(x(3)+(-1).*x(4))+m2.*((-4).*x(3).*sin(x(1)+(-1).* ...
  x(2)).^2+4.*x(4).*sin(x(1)+(-1).*x(2)).^2+dt.*x(3).^2.*sin(2.*( ...
  x(1)+(-1).*x(2)))+dt.*x(4).^2.*sin(2.*(x(1)+(-1).*x(2))))))).*sin( ...
  (1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2))+(-2).*L1.*((2.*dt.* ...
  L2.*((-1).*u(1)+u(2))+2.*dt.*L1.*(u(2).*cos(x(1)+(-1).*x(2))+L2.^2.*m2.* ...
  x(4).^2.*sin(x(1)+(-1).*x(2))+g.*L2.*(m1.*sin(x(1))+m2.*cos(x(2)) ...
  .*sin(x(1)+(-1).*x(2))))+L1.^2.*L2.*x(3).*((-4).*m1+m2.*((-4).* ...
  sin(x(1)+(-1).*x(2)).^2+dt.*x(3).*sin(2.*(x(1)+(-1).*x(2)))))).* ...
  sin((1/2).*dt.*(x(3)+(-1).*x(4))+x(1)+(-1).*x(2)).*(2.*L1.*L2.^2.* ...
  m2.*x(4).*(m1+m2.*sin(x(1)+(-1).*x(2)).^2)+dt.*L2.*m2.*cos(x(1)+( ...
  -1).*x(2)).*((-1).*u(1)+u(2)+L1.*(g.*m1.*sin(x(1))+m2.*(g.*sin(x(1))+ ...
  L2.*x(4).^2.*sin(x(1)+(-1).*x(2)))))+dt.*L1.*(m1+m2).*(u(2)+(-1).* ...
  L2.*m2.*((-1).*L1.*x(3).^2.*sin(x(1)+(-1).*x(2))+g.*sin(x(2)))))+ ...
  8.*g.*L1.^2.*L2.^3.*m2.*(m1+m2.*sin(x(1)+(-1).*x(2)).^2).^2.*sin(( ...
  1/2).*dt.*x(4)+x(2)))));


A = [a11,a12,a13,a14;a21,a22,a23,a24;a31,a32,a33,a34;a41,a42,a43,a44];

